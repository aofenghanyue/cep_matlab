# GJB 6289-2008 导弹命中精度评定工具箱 (MATLAB)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

这是一个基于MATLAB实现的、用于评定地地弹道式导弹命中精度的计算工具箱。本工具箱严格遵循中华人民共和国国家军用标准 **GJB 6289-2008《地地弹道式导弹命中精度评定方法》** 进行开发，旨在为相关领域的科研人员和工程师提供一个精确、可靠且易于使用的开源计算工具。

## 主要功能

本工具箱完整实现了GJB 6289-2008标准中定义的核心评定方法：

1.  **数据预检验**:
    *   **正态性检验**: 使用 Shapiro-Francia 检验（一种高效的Shapiro-Wilk替代方法）判断落点偏差数据是否服从正态分布。
    *   **独立性检验**: 使用皮尔逊相关系数检验判断纵向和横向偏差是否独立。

2.  **圆概率误差 (CEP) 点估计**:
    *   计算CEP的代入型点估计值 `R̂`。
    *   采用高精度的**极坐标数值积分**方法，避免了笛卡尔坐标下的奇异性问题。

3.  **CEP 区间估计**:
    *   **参数自助法 (Parametric Bootstrap)**: 一种基于蒙特卡洛模拟的稳健方法，推荐使用。
    *   **一阶逼近法 (First-Order Approximation)**:
        *   提供两种偏导数计算内核，可自由切换：
            1.  **快速数值差分法**：速度快，适用于快速迭代和初步分析。
            2.  **GJB附录B解析公式法**：精度高，完全忠实于标准，适用于最终报告和验证，但计算速度较慢。

4.  **贝叶斯精度评定 (适用于小样本)**:
    *   完整实现了标准第8章的**贝叶斯参数自助估计方法**。
    *   允许在试验样本极少（如 n ≤ 3）的情况下，结合补充样本（先验信息）进行更可靠的精度评定。
    *   严格遵循标准中定义的特定先验分布和后验参数更新公式。

## 文件结构

```
.
├── main.m                    # 主运行脚本，用户入口
├── calculate_cep_analysis.m  # 核心分析函数 (常规方法)
├── calculate_cep_bayesian.m  # 核心分析函数 (贝叶斯方法)
├── calculate_cep_plugin.m    # CEP点估计计算函数 (两种内核)
├── calculate_ci_bootstrap.m  # 参数自助法置信区间计算函数
├── calculate_ci_first_order.m# 一阶逼近法置信区间计算函数 (两种内核)
├── sf_test.m                 # Shapiro-Francia 正态性检验函数
├── invgamrnd.m               # 逆伽玛分布随机数生成函数
└── README.md                 # 本说明文件
```

## 如何使用

1.  **准备数据**: 将纵向落点偏差数据 (`x`) 和横向落点偏差数据 (`z`) 准备好。
2.  **配置参数**: 打开主脚本 `main_cep_script.m`。
    *   在 **"1. 输入数据"** 部分，填入数据。脚本中已包含GJB标准中的两个示例，可用于验证。
    *   在 **"2. 设置参数"** 部分，可以根据需要修改以下参数：
        *   `test_alpha`: 数据预检验的显著性水平（规范推荐0.10）。
        *   `confidence_level_std` / `confidence_level_bayes`: CEP置信区间的置信水平。
        *   `simulation_iterations`: 蒙特卡洛模拟的次数（推荐2000-5000）。
        *   `calculate_ci_first_order:method`: 一阶逼近法的计算内核选择 (1=快速, 2=精确)。
3.  **运行**: 直接在MATLAB中运行 `main_cep_script.m` 脚本。
4.  **查看结果**: 所有计算结果将清晰地格式化输出在MATLAB的命令窗口中，并附有与GJB标准示例的对比，方便验证正确性。

## 示例输出

```
====================================================
执行常规精度评定 (GJB 第6、7章)
====================================================
正在根据 GJB 6289-2008 标准进行计算...
样本数量 n = 9
置信水平 = 80.00%

  正在进行数据有效性检验 (显著性水平 α = 0.10)...
  [检验通过] 数据通过正态性检验。
  [检验通过] 数据通过独立性检验 (P-value = 0.3493 >= 0.10)。

  正在进行参数自助法计算 (模拟 2000 次)...
  参数自助法计算完成。
  正在进行一阶逼近法计算...
    正在计算附录B中的积分项...
    积分项计算完成。
  一阶逼近法计算完成。

----------- [常规方法] 计算结果 -----------

[基础统计参数]
  原始数据 (变换前):
    μ_x = 62.4689, σ_x = 43.3628
    μ_z = 6.1456, σ_z = 120.7993
    ρ   = 0.00000

[CEP 点估计 (Point Estimation)]
  代入型点估计 (Plug-in): R̂ = 116.9658

[CEP 区间估计 (Interval Estimation)]
  方法 1: 参数自助法 (Parametric Bootstrap) - 推荐
    置信区间: [96.3704, 142.4707]
    置信上界: 132.9979

  方法 2: 一阶逼近法 (First-Order Approximation)
    置信区间: [96.7560, 141.3970]
    置信上界: 132.4831

------------------- GJB 示例对比 -----------------
GJB 6289-2008 表3中，置信水平为0.90时:
  点估计 R̂         = 116.97 m
  自助法置信区间   ≈ [91.18, 150.87] m
  一阶逼近置信区间 ≈ [91.69, 149.21] m
--------------------------------------------------

====================================================
执行贝叶斯精度评定 (GJB 第8章, 适用于小样本)
====================================================
试验样本数量 n = 3
补充样本数量 n₀ = 3
置信水平 = 80.00%

  正在进行贝叶斯参数抽样 (模拟 2000 次)...
  贝叶斯参数抽样完成。

----------- [贝叶斯方法] 计算结果 -----------

[CEP 贝叶斯点估计]
  点估计 (R_ba): 1013.6851

[CEP 贝叶斯置信区间/上界]
  置信区间: [733.0071, 1338.5960]
  置信上界: 1198.2246

------------------- GJB 示例对比 -----------------
GJB 6289-2008 8.3节示例中，置信水平为0.80时:
  贝叶斯点估计 R_ba   = 1011.5 m
  贝叶斯置信区间      = [722.6, 1374.1] m
  贝叶斯置信上界      = 1195 m
--------------------------------------------------

```

## 许可证

本项目采用 [MIT License](https://opensource.org/licenses/MIT) 开源。